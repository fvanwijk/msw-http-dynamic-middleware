"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("pino")),t=require("msw"),n=e(require("path")),a=e(require("express")).static(n.join(__dirname,"ui")),o=r({prettyPrint:{translateTime:!0,ignore:"pid,hostname"}}),i=function(e,r,t){return r(t.status(200))},s=function(e){if(e instanceof RegExp)throw new Error("Only strings as path are supported");return!0},u=function(e,r,t){var n=e[r];if(!n)throw new Error('Scenario "'+r+'" does not exist');var a=(Array.isArray(n)?n:[n]).map((function(e){var r=e.info,n=r.path,a=r.method,o=r.header;if(s(n))return n in t||(t[n]={}),t[n][a]=e.resolver,o}));o.info('Set scenario "'+r+'" with resolvers for endpoints: '+a.join(", "))};exports.createHandlers=function(e,r){var n={};return r&&u(e,r,n),[].concat(Object.values(e).flatMap((function(e){return(Array.isArray(e)?e:[e]).map((function(e){var r=e.info,a=r.method,u=r.path,c=r.header;return s(u),t.rest[a.toLowerCase()](u,(function(e,r,t){if(s(u)){var f,d=null==(f=n[u])?void 0:f[a];return d?o.info(c):(d=i,o.info(c+" (default resolver)")),d(e,r,t)}}))}))})),[t.rest.get("/scenario",(function(r,t,n){var a=Object.entries(e).reduce((function(e,r){var t=r[1],n=function(e){return{header:e.header,method:e.method,path:e.path.toString()}};return e[r[0]]=Array.isArray(t)?t.map((function(e){return n(e.info)})):n(t.info),e}),{});return t(n.json({scenarios:a}))})),t.rest.put("/scenario",(function(r,t,a){var o,i=null==(o=r.body)?void 0:o.scenario;if(!i)return t(a.status(400),a.text('Please provide a scenario name in the request body. Example: { "scenario": "user success" }'));try{u(e,i,n)}catch(e){return t(a.status(400),a.text(e.message))}return t(a.status(205))})),t.rest.delete("/scenario",(function(t,a,i){n={};var s=t.url.searchParams.get("resetAll");return r&&"true"!==(null==s?void 0:s.toLowerCase())?(o.info("Reset server to default scenario"),u(e,r,n)):o.info("Reset all handlers to default resolver"),a(i.status(205))}))])},exports.middleware=a;
//# sourceMappingURL=msw-dynamic-http-middleware.cjs.production.min.js.map
