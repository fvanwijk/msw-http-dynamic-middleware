"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,r=(e=require("pino"))&&"object"==typeof e&&"default"in e?e.default:e,t=require("msw"),n=r({prettyPrint:{translateTime:!0,ignore:"pid,hostname"}}),o=function(e,r,t){return r(t.status(200))},a=function(e){if(e instanceof RegExp)throw new Error("Only strings as path are supported");return!0},s=function(e,r,t){var o=e[r];if(!o)throw new Error('Scenario "'+r+'" does not exist');var s=(Array.isArray(o)?o:[o]).map((function(e){var r=e.info,n=r.path,o=r.method,s=r.header;if(a(n))return n in t||(t[n]={}),t[n][o]=e.resolver,s}));n.info('Set scenario "'+r+'" with resolvers for endpoints: '+s.join(", "))};exports.createHandlers=function(e,r){var i={};return r&&s(e,r,i),[].concat(Object.values(e).flatMap((function(e){return(Array.isArray(e)?e:[e]).map((function(e){var r=e.info,s=r.method,u=r.path,c=r.header;return a(u),t.rest[s.toLowerCase()](u,(function(e,r,t){if(a(u)){var f,l=null==(f=i[u])?void 0:f[s];return l?n.info(c):(l=o,n.info(c+" (default resolver)")),l(e,r,t)}}))}))})),[t.rest.get("/scenario",(function(r,t,n){return t(n.json(e))})),t.rest.put("/scenario",(function(r,t,n){var o,a=null==(o=r.body)?void 0:o.scenario;if(!a)return t(n.status(400),n.text('Please provide a scenario name in the request body. Example: { "scenario": "user success" }'));try{s(e,a,i)}catch(e){t(n.status(400),n.text(e.message))}return t(n.status(205))})),t.rest.delete("/scenario",(function(t,o,a){i={};var u=t.url.searchParams.get("resetAll");return r&&"true"!==(null==u?void 0:u.toLowerCase())?(n.info("Reset server to default scenario"),s(e,r,i)):n.info("Reset all handlers to default resolver"),o(a.status(205))}))])};
//# sourceMappingURL=msw-dynamic-http-middleware.cjs.production.min.js.map
